{
  "version": "1",
  "metadata": {
    "marimo_version": "0.18.4"
  },
  "cells": [
    {
      "id": "vblA",
      "code_hash": "1198e5f0179a062358bb6f27eea84cff",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/markdown": "<span class=\"markdown prose dark:prose-invert contents\"><h2 id=\"step-1\">Step 1: \u30cd\u30fc\u30e0\u30b9\u30da\u30fc\u30b9\u306e\u4f5c\u6210</h2>\n<span class=\"paragraph\">Iceberg\u3067\u306f\u30c6\u30fc\u30d6\u30eb\u3092\u30cd\u30fc\u30e0\u30b9\u30da\u30fc\u30b9\uff08\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u76f8\u5f53\uff09\u3067\u6574\u7406\u3057\u307e\u3059\u3002</span></span>"
          }
        }
      ],
      "console": []
    },
    {
      "id": "lEQa",
      "code_hash": "da671f9f82961b732b8f5519f2e7eb63",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/markdown": "<span class=\"markdown prose dark:prose-invert contents\"><h2 id=\"step-2\">Step 2: \u30c6\u30fc\u30d6\u30eb\u306e\u4f5c\u6210</h2>\n<span class=\"paragraph\">\u30e6\u30fc\u30b6\u30fc\u60c5\u5831\u3092\u683c\u7d0d\u3059\u308b\u30c6\u30fc\u30d6\u30eb\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002</span></span>"
          }
        }
      ],
      "console": []
    },
    {
      "id": "Xref",
      "code_hash": "9294a788cc741390d05b229b094eaa51",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/markdown": "<span class=\"markdown prose dark:prose-invert contents\"><h2 id=\"step-3\">Step 3: \u30c7\u30fc\u30bf\u306e\u8ffd\u52a0</h2>\n<span class=\"paragraph\">PyArrow\u3092\u4f7f\u3063\u3066\u30c7\u30fc\u30bf\u3092\u8ffd\u52a0\u3057\u307e\u3059\u3002</span></span>"
          }
        }
      ],
      "console": []
    },
    {
      "id": "BYtC",
      "code_hash": "3f233d8d167bc55b738366ddd2a2ced8",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/markdown": "<span class=\"markdown prose dark:prose-invert contents\"><h2 id=\"step-4\">Step 4: \u30c7\u30fc\u30bf\u306e\u8aad\u307f\u53d6\u308a</h2></span>"
          }
        }
      ],
      "console": []
    },
    {
      "id": "Kclp",
      "code_hash": "9abf0298a5c36f5873dc1b1b19c05ee1",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/markdown": "<span class=\"markdown prose dark:prose-invert contents\"><h2 id=\"step-5\">Step 5: \u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u306e\u78ba\u8a8d</h2>\n<span class=\"paragraph\">Iceberg\u306f\u5404\u64cd\u4f5c\u3092\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u3068\u3057\u3066\u8a18\u9332\u3057\u307e\u3059\u3002</span></span>"
          }
        }
      ],
      "console": []
    },
    {
      "id": "Hstk",
      "code_hash": "5711693c28135996998abec61da7f489",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/markdown": "<span class=\"markdown prose dark:prose-invert contents\"><h2 id=\"step-6\">Step 6: \u30e1\u30bf\u30c7\u30fc\u30bf\u306e\u78ba\u8a8d</h2>\n<span class=\"paragraph\">\u30c6\u30fc\u30d6\u30eb\u306e\u30e1\u30bf\u30c7\u30fc\u30bf\u60c5\u5831\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002</span></span>"
          }
        }
      ],
      "console": []
    },
    {
      "id": "iLit",
      "code_hash": "eae68690f16f742aee962f5e5269ba6d",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/markdown": "<span class=\"markdown prose dark:prose-invert contents\"><hr />\n<h2 id=\"_1\">\u6b21\u306e\u30b9\u30c6\u30c3\u30d7</h2>\n<ul>\n<li><strong>02_pyspark_multiengine.py</strong>: PySpark\u3067\u540c\u3058\u30c6\u30fc\u30d6\u30eb\u306b\u30a2\u30af\u30bb\u30b9</li>\n<li><strong>03_trino_sql.py</strong>: Trino\u3067SQL\u30af\u30a8\u30ea\u3092\u5b9f\u884c</li>\n</ul>\n<span class=\"paragraph\">\u30de\u30eb\u30c1\u30a8\u30f3\u30b8\u30f3\u3067\u306e\u76f8\u4e92\u904b\u7528\u6027\u3092\u78ba\u8a8d\u3057\u3066\u307f\u307e\u3057\u3087\u3046\uff01</span></span>"
          }
        }
      ],
      "console": []
    },
    {
      "id": "Hbol",
      "code_hash": "1790493c601b7d36d9acf2a2e0550b72",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/markdown": "<span class=\"markdown prose dark:prose-invert contents\"><h1 id=\"pyicebergiceberg\">\ud83e\uddca PyIceberg\u3067Iceberg\u30c6\u30fc\u30d6\u30eb\u3092\u64cd\u4f5c\u3059\u308b</h1>\n<span class=\"paragraph\">\u3053\u306e\u30ce\u30fc\u30c8\u30d6\u30c3\u30af\u3067\u306f\u3001PyIceberg\u3092\u4f7f\u3063\u3066Apache Iceberg\u30c6\u30fc\u30d6\u30eb\u306e\u57fa\u672c\u64cd\u4f5c\u3092\u5b66\u3073\u307e\u3059\u3002</span>\n<h2 id=\"_1\">\u74b0\u5883\u69cb\u6210</h2>\n<ul>\n<li><strong>\u30ab\u30bf\u30ed\u30b0</strong>: REST Catalog\uff08tabulario/iceberg-rest\uff09</li>\n<li><strong>\u30b9\u30c8\u30ec\u30fc\u30b8</strong>: MinIO\uff08S3\u4e92\u63db\uff09</li>\n<li><strong>\u30ce\u30fc\u30c8\u30d6\u30c3\u30af</strong>: marimo</li>\n</ul></span>"
          }
        }
      ],
      "console": []
    },
    {
      "id": "MJUe",
      "code_hash": "75575a339b5d27abd6c8269ee77b8051",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/plain": ""
          }
        }
      ],
      "console": [
        {
          "type": "stream",
          "name": "stdout",
          "text": "\u30ab\u30bf\u30ed\u30b0\u63a5\u7d9a\u6210\u529f: rest (<class 'pyiceberg.catalog.rest.RestCatalog'>)\n",
          "mimetype": "text/plain"
        }
      ]
    },
    {
      "id": "bkHC",
      "code_hash": "7002a995ae72d8854f72f2af03f50600",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/plain": ""
          }
        }
      ],
      "console": [
        {
          "type": "stream",
          "name": "stdout",
          "text": "\u65e2\u5b58\u306e\u30cd\u30fc\u30e0\u30b9\u30da\u30fc\u30b9: []\n\u30cd\u30fc\u30e0\u30b9\u30da\u30fc\u30b9 'demo' \u3092\u4f5c\u6210\u3057\u307e\u3057\u305f\n\u30cd\u30fc\u30e0\u30b9\u30da\u30fc\u30b9\u4e00\u89a7: [('demo',)]\n",
          "mimetype": "text/plain"
        }
      ]
    },
    {
      "id": "PKri",
      "code_hash": "44ba171568c37a5f3b99184bafded9ce",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/plain": ""
          }
        }
      ],
      "console": [
        {
          "type": "stream",
          "name": "stdout",
          "text": "\u30c6\u30fc\u30d6\u30eb 'demo.users' \u3092\u4f5c\u6210\u3057\u307e\u3057\u305f\nusers(\n  1: user_id: required long,\n  2: name: required string,\n  3: email: optional string,\n  4: score: optional double\n),\npartition by: [],\nsort order: [],\nsnapshot: null\n",
          "mimetype": "text/plain"
        }
      ]
    },
    {
      "id": "SFPL",
      "code_hash": "37ab2443ab41fff926c652a4c7951189",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/plain": ""
          }
        }
      ],
      "console": [
        {
          "type": "stream",
          "name": "stdout",
          "text": "3\u4ef6\u306e\u30c7\u30fc\u30bf\u3092\u8ffd\u52a0\u3057\u307e\u3057\u305f\n",
          "mimetype": "text/plain"
        }
      ]
    },
    {
      "id": "RGSE",
      "code_hash": "967f9c667a29037df2d246776b044810",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/html": "<marimo-ui-element object-id='RGSE-0' random-id='c3e1a1f5-a58b-861e-8724-1df9242d5ca3'><marimo-table data-initial-value='[]' data-label='null' data-data='&quot;[{&#92;&quot;user_id&#92;&quot;:1,&#92;&quot;name&#92;&quot;:&#92;&quot;Alice&#92;&quot;,&#92;&quot;email&#92;&quot;:&#92;&quot;alice@example.com&#92;&quot;,&#92;&quot;score&#92;&quot;:85.5},{&#92;&quot;user_id&#92;&quot;:2,&#92;&quot;name&#92;&quot;:&#92;&quot;Bob&#92;&quot;,&#92;&quot;email&#92;&quot;:&#92;&quot;bob@example.com&#92;&quot;,&#92;&quot;score&#92;&quot;:92.0},{&#92;&quot;user_id&#92;&quot;:3,&#92;&quot;name&#92;&quot;:&#92;&quot;Charlie&#92;&quot;,&#92;&quot;email&#92;&quot;:null,&#92;&quot;score&#92;&quot;:78.5}]&quot;' data-total-rows='3' data-total-columns='4' data-max-columns='50' data-banner-text='&quot;&quot;' data-pagination='true' data-page-size='10' data-field-types='[[&quot;user_id&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;name&quot;,[&quot;string&quot;,&quot;object&quot;]],[&quot;email&quot;,[&quot;string&quot;,&quot;object&quot;]],[&quot;score&quot;,[&quot;number&quot;,&quot;float64&quot;]]]' data-show-filters='true' data-show-download='true' data-show-column-summaries='false' data-show-data-types='true' data-show-page-size-selector='false' data-show-column-explorer='true' data-show-chart-builder='true' data-row-headers='[]' data-has-stable-row-id='false' data-lazy='false' data-preload='false'></marimo-table></marimo-ui-element>"
          }
        }
      ],
      "console": [
        {
          "type": "stream",
          "name": "stderr",
          "text": "/usr/local/lib/python3.11/site-packages/pyiceberg/avro/decoder.py:185: UserWarning: Falling back to pure Python Avro decoder, missing Cython implementation\n  warnings.warn(\"Falling back to pure Python Avro decoder, missing Cython implementation\")\n",
          "mimetype": "text/plain"
        }
      ]
    },
    {
      "id": "emfo",
      "code_hash": "f531c00fcde8cbf51e3b06c59795f985",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/html": "<marimo-ui-element object-id='emfo-0' random-id='ce7457ac-ab4c-fec8-6798-f7fff99b27be'><marimo-table data-initial-value='[]' data-label='null' data-data='&quot;[{&#92;&quot;Snapshot ID&#92;&quot;:3173858814492672581,&#92;&quot;Operation&#92;&quot;:{&#92;&quot;_value_&#92;&quot;:&#92;&quot;append&#92;&quot;,&#92;&quot;_name_&#92;&quot;:&#92;&quot;APPEND&#92;&quot;,&#92;&quot;__objclass__&#92;&quot;:&#92;&quot;mappingproxy({&#x27;_generate_next_value_&#x27;: &lt;function Enum._generate_next_value_ at 0xffff97c42ca0&gt;, &#x27;__module__&#x27;: &#x27;pyiceberg.table.snapshots&#x27;, &#x27;__doc__&#x27;: &#x27;Describes the operation.&#92;&#92;&#92;&#92;n&#92;&#92;&#92;&#92;n    Possible operation values are:&#92;&#92;&#92;&#92;n        - append: Only data files were added and no files were removed.&#92;&#92;&#92;&#92;n        - replace: Data and delete files were added and removed without changing table data; i.e., compaction, changing the data file format, or relocating data files.&#92;&#92;&#92;&#92;n        - overwrite: Data and delete files were added and removed in a logical overwrite operation.&#92;&#92;&#92;&#92;n        - delete: Data files were removed and their contents logically deleted and/or delete files were added to delete rows.&#92;&#92;&#92;&#92;n    &#x27;, &#x27;__repr__&#x27;: &lt;function Operation.__repr__ at 0xffff6ed26f20&gt;, &#x27;_new_member_&#x27;: &lt;built-in method __new__ of type object at 0xffff98593fe8&gt;, &#x27;_use_args_&#x27;: False, &#x27;_member_names_&#x27;: [&#x27;APPEND&#x27;, &#x27;REPLACE&#x27;, &#x27;OVERWRITE&#x27;, &#x27;DELETE&#x27;], &#x27;_member_map_&#x27;: {&#x27;APPEND&#x27;: Operation.APPEND, &#x27;REPLACE&#x27;: Operation.REPLACE, &#x27;OVERWRITE&#x27;: Operation.OVERWRITE, &#x27;DELETE&#x27;: Operation.DELETE}, &#x27;_value2member_map_&#x27;: {&#x27;append&#x27;: Operation.APPEND, &#x27;replace&#x27;: Operation.REPLACE, &#x27;overwrite&#x27;: Operation.OVERWRITE, &#x27;delete&#x27;: Operation.DELETE}, &#x27;_unhashable_values_&#x27;: [], &#x27;_member_type_&#x27;: &lt;class &#x27;object&#x27;&gt;, &#x27;_value_repr_&#x27;: None, &#x27;APPEND&#x27;: Operation.APPEND, &#x27;REPLACE&#x27;: Operation.REPLACE, &#x27;OVERWRITE&#x27;: Operation.OVERWRITE, &#x27;DELETE&#x27;: Operation.DELETE, &#x27;__new__&#x27;: &lt;function Enum.__new__ at 0xffff97c42b60&gt;})&#92;&quot;,&#92;&quot;_sort_order_&#92;&quot;:0},&#92;&quot;Added Records&#92;&quot;:&#92;&quot;3&#92;&quot;,&#92;&quot;Timestamp&#92;&quot;:1766807058181}]&quot;' data-total-rows='1' data-total-columns='4' data-max-columns='50' data-banner-text='&quot;&quot;' data-pagination='false' data-page-size='10' data-selection='&quot;multi&quot;' data-show-filters='false' data-show-download='true' data-show-column-summaries='false' data-show-data-types='true' data-show-page-size-selector='false' data-show-column-explorer='true' data-show-chart-builder='true' data-row-headers='[]' data-has-stable-row-id='false' data-lazy='false' data-preload='false'></marimo-table></marimo-ui-element>"
          }
        }
      ],
      "console": []
    },
    {
      "id": "nWHF",
      "code_hash": "d42f45dcd8aeb777c371c8fdcf0efc0a",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/plain": ""
          }
        }
      ],
      "console": [
        {
          "type": "stream",
          "name": "stdout",
          "text": "\u30c6\u30fc\u30d6\u30ebUUID: 11ca1749-7239-4608-b0d4-bd81eeee2e24\n\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u30d0\u30fc\u30b8\u30e7\u30f3: 2\n\u30ed\u30b1\u30fc\u30b7\u30e7\u30f3: s3://warehouse/demo/users\n\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u6570: 1\n",
          "mimetype": "text/plain"
        }
      ]
    }
  ]
}